/*!
 * KoliBri - the accessible web component library
 */
import{r as t,h as e,H as s}from"./index-5f2fc243.js";import{b as i}from"./dev.utils-2cf8d1a6.js";import{s as r,d as n}from"./prop.validators-65dada2e.js";import"./index.m-0a218bb8.js";import"./a11y.tipps-aa545fdc.js";import"./register-65f59344.js";function o(t){return t instanceof h?t.get():Array.isArray(t)?t:[t]}class h{constructor(t){this.items=new Set,this.protectedItems=new Set,this.instancesOf=Array.isArray(t)?t:[t]}get empty(){return 0===this.items.size}get first(){return this.items.size>0?Array.from(this.items)[0]:null}forEach(t){this.items.forEach(t)}filter(t){return Array.from(this.items).filter(t)}find(t){return Array.from(this.items).find(t)}get last(){return this.items.size>0?Array.from(this.items)[this.items.size-1]:null}get length(){return i.debug("The attribute ListOf.length is deprecated - please use ListOf.size instead."),this.size}get size(){return this.items.size}add(t,e=!1){return o(t).filter((t=>{let s=!1;return!1===this.has(t)?function(t,e){return!!Array.isArray(t)&&void 0!==t.find((t=>e instanceof t))}(this.instancesOf,t)?(e&&this.protectedItems.add(t),this.items.add(t),s=!0):i.debug("The item does not have a valid instance type.",this):i.debug("The item is already in the list.",this),s})).length>0}remove(t){return i.debug("The method ListOf.remove() is deprecated - please use ListOf.delete() instead."),this.delete(t)}delete(t){return o(t).filter((t=>{let e=!1;return!1===this.protectedItems.has(t)?this.items.has(t)?(this.items.delete(t),e=!0):i.debug("The item is not in the list.",this):i.debug("The item is protected and cannot be removed.",this),e})).length>0}set(t,e=!1){const s=this.clear(),r=this.add(t,e);return s||r}get(t){return!1===isNaN(t)&&"number"==typeof t?Array.from(this.items).slice(0,t):Array.from(this.items)}clear(){const t=this.items.size;return this.items.forEach((t=>{!1===this.protectedItems.has(t)&&this.items.delete(t)})),t!==this.items.size}contains(t){return i.debug("The method ListOf.contains() is deprecated - please use ListOf.has() instead."),this.items.has(t)}has(t){return this.items.has(t)}}class a{}class l extends h{constructor(){super(a),this.formatters=this}format(t){return this.formatters.forEach((e=>{t=e.format(t)})),t}parse(t){return this.formatters.forEach((e=>{t=e.parse(t)})),t}}class u{constructor(t){this.state={message:"An unknown validation error occurred."},this.message=t}set message(t){"string"==typeof t&&t.length>0?this.state.message=t:i.error("The message of the validator should be type of string with a min-length of 1.")}get message(){return this.state.message}}class c extends h{constructor(){super(u),this.validators=this,this.validators=this}validate(t,e=!1){const s=[];try{this.validators.forEach((r=>{if(!1===r.valid(t)&&(s.push(r.message),!0===e))throw new Error("Only one error is enough. Be quick and stop the execution of other validation functions.")}))}catch(t){}return s}}class f{constructor(t){this.changeListeners=new h(Function),this._errors=new Set,this._parentForms=new Set,this._name="unnamed",this._validationHandler=new c,this.name=t}get name(){return this._name}set name(t){if("string"!=typeof t)throw new Error("The name of a control must be a string.");if(!(t.length>0))throw new Error("The name of a control must have a min-length of 1.");this._name=t}get error(){return this._errors.size>0?this._errors.values().next().value:null}getErrors(){return this._errors}get id(){let t=this.name;return this._parentForms.size>0&&(t=`${this._parentForms.values().next().value.id}_${t}`),t}get valid(){return 0===this._errors.size}findMeInParentForm(t){if(this===t)return!0;if(t instanceof m){const e=[];return this._parentForms.forEach((s=>{!0===s.findMeInParentForm(t)&&e.push(s)})),e.length>0}return!1}addParentForm(t){if(!1!==this._parentForms.has(t))throw new Error(`An form control with the name '${t.name}' already exists.`);if(!1!==t.findMeInParentForm(this))throw new Error(`The same form control (${t.name}) leads to a form control loop.`);this._parentForms.add(t)}removeParentForm(t){if(!0!==this._parentForms.has(t))throw new Error(`An form control with the name '${t.name}' does not exists.`);this._parentForms.delete(t)}setValidationHandler(t,e=null){this._validationHandler=t,this.validate(e),this.notify()}validate(t){this._errors.clear(),this._validationHandler.validate(t).forEach((t=>{this._errors.add(t)})),this._parentForms.forEach((t=>{t.validate(t.getData())}))}notify(...t){this.changeListeners.forEach((e=>{e(...t)})),this._parentForms.forEach((t=>{t.notify(t.getData())}))}}var d;!function(t){t.checkbox="checkbox",t.date="date",t.email="email",t.number="number",t.password="password",t.radio="radio",t.select="select",t.slider="slider",t.text="text"}(d||(d={}));class p extends f{constructor(t,e){super(t),this._disabled=!1,this._label="",this._mandatory=!1,this._placeholder="",this._readonly=!1,this._type="text",this._value=null,this._oldValue=null,this._formatHandler=new l,"object"==typeof e&&null!==e&&(this.disabled=!0===e.disabled,this.label="string"==typeof e.label?e.label:"",this.mandatory=!0===e.mandatory,this.placeholder="string"==typeof e.placeholder?e.placeholder:"",this.readonly=!0===e.disabled,this.type="string"==typeof e.type?e.type:"text",this.value=void 0!==e.value?e.value:null)}get disabled(){return this._disabled}set disabled(t){if("boolean"!=typeof t)throw new Error("The disabled flag of a input control must be a string.");this._disabled=t,this.notify()}get mandatory(){return this._mandatory}set mandatory(t){if("boolean"!=typeof t)throw new Error("The mandatory flag of a input control must be a string.");this._mandatory=t,this.notify()}get readonly(){return this._readonly}set readonly(t){if("boolean"!=typeof t)throw new Error("The readonly flag of a input control must be a string.");this._readonly=t,this.notify()}get label(){return this._label}set label(t){if("string"!=typeof t)throw new Error("The label of a input control must be a string.");this._label=t,this.notify()}get placeholder(){return this._placeholder}set placeholder(t){if("string"!=typeof t)throw new Error("The placeholder of a input control must be a string.");this._placeholder=t,this.notify()}get type(){return this._type.toString()}set type(t){if("string"!=typeof t)throw new Error("The type of a input control must be a string.");switch(t){case"checkbox":case"date":case"email":case"number":case"password":case"radio":case"select":case"slider":case"text":this._type=t,this.notify();break;default:throw new Error("The type of a input control must be a of the following types: ???.")}}get oldValue(){return this._oldValue}get value(){return this._value}set value(t){this._oldValue=this._value,this._value=t,this.validate(t),this.notify()}get modelValue(){return this.value}set modelValue(t){this.value=t}get viewValue(){return this._formatHandler.format(this.modelValue)}set viewValue(t){this.modelValue=this._formatHandler.parse(t)}notify(){super.notify(this._value,this._oldValue)}setValidationHandler(t){super.setValidationHandler(t,this.value)}setFormatHandler(t){this._formatHandler=t}}class m extends f{constructor(){super(...arguments),this.controls=new Set}get disabled(){return 0===Array.from(this.controls).filter((t=>!1===t.disabled)).length}set disabled(t){this.controls.forEach((e=>{e.disabled=t}))}get readonly(){return 0===Array.from(this.controls).filter((t=>!1===t.readonly)).length}set readonly(t){this.controls.forEach((e=>{e.readonly=t}))}get valid(){return super.valid&&0===Array.from(this.controls).filter((t=>!1===t.valid)).length}addControl(t){if(!1!==this.controls.has(t))throw new Error(`A control with the same name '${t.name}' already exists.`);t.addParentForm(this),this.controls.add(t)}removeControl(t){if(!0!==this.controls.has(t))throw new Error(`A control with the name '${t.name}' does not exists.`);t instanceof f&&(t.removeParentForm(this),this.controls.delete(t))}getControls(){return Array.from(this.controls)}getControl(t){return Array.from(this.controls).find((e=>e.name===t))}getForms(){return Array.from(this.controls).filter((t=>t instanceof m))}getForm(t){return Array.from(this.getForms()).find((e=>e.name===t))}getInputs(){return Array.from(this.controls).filter((t=>t instanceof p))}getInput(t){return Array.from(this.getInputs()).find((e=>e.name===t))}setData(t){this.controls.forEach((e=>{if(void 0!==t[e.name])if(e instanceof m)e.setData(t[e.name]);else{if(!(e instanceof p))throw new Error("The control is neither an instance of FormControl or InputControl.");e.value=t[e.name]}}))}getData(){const t={};return this.controls.forEach((e=>{if(e instanceof m)t[e.name]=e.getData();else{if(!(e instanceof p))throw new Error("The control is neither an instance of FormControl or InputControl.");t[e.name]=e.value}})),t}setValidationHandler(t){super.setValidationHandler(t)}}new class extends a{constructor(){super(...arguments),this.regExp=/([A-Z0-9]{1,4})/gi}format(t){if("string"==typeof t){const e=t.match(this.regExp);if(Array.isArray(e))return null==e?void 0:e.join(" ")}return t}parse(t){return"string"==typeof t?t.replace(/ /g,""):t}};const g=new class extends u{constructor(t="Please enter a value."){super(t)}valid(t){return null!=t&&t.toString().length>0}};class y extends u{valid(t){return!1===g.valid(t)||this.validate(t)}}class w extends y{constructor(t,e="Please enter a valid value."){super(e),this._regExp=/^/g,this.regExp=t}set regExp(t){t instanceof RegExp?this._regExp=t:i.debug("The regExp of the pattern validator should be type of RegExp.")}get regExp(){return this._regExp}validate(t){return this.regExp.test(t)}}const b=/^\d+$/;var v,x,E;new class extends w{constructor(t="Please enter a number."){super(b,t)}},function(t){t.color="color",t.date="date",t["datetime-local"]="datetime-local",t.email="email",t.file="file",t.month="month",t.number="number",t.password="password",t.range="range",t.search="search",t.tel="tel",t.text="text",t.time="time",t.url="url",t.week="week",t.textarea="textarea"}(v||(v={})),function(t){t.checkbox="checkbox",t.radio="radio",t.select="select"}(x||(x={})),function(t){t.onBlur="onBlur",t.onClick="onClick",t.onChange="onChange",t.onFocus="onFocus",t.onInput="onInput"}(E||(E={}));const k=new p("unknown",{label:""}),A=class{constructor(e){t(this,e),this._debounce=250,this._on={},this.state={_control:k,_debounce:250,_on:{}},this.changeListener=()=>{this.syncControl()},this.onChange=(t,e)=>{"object"==typeof this.state._control&&(this.state._control.viewValue=e),"object"==typeof this.state._on&&null!==this.state._on&&"function"==typeof this.state._on.onChange&&this.state._on.onChange(t,e)},this.syncControl=()=>{this.hostElement instanceof HTMLElement&&(this.propagateControl(this.hostElement,"kol-input-checkbox"),this.propagateControl(this.hostElement,"kol-input-color"),this.propagateControl(this.hostElement,"kol-input-date"),this.propagateControl(this.hostElement,"kol-input-email"),this.propagateControl(this.hostElement,"kol-input-file"),this.propagateControl(this.hostElement,"kol-input-number"),this.propagateControl(this.hostElement,"kol-input-range"),this.propagateControl(this.hostElement,"kol-input-text"),this.propagateControl(this.hostElement,"kol-input-password"),this.propagateControl(this.hostElement,"kol-input-radio"),this.propagateControl(this.hostElement,"kol-input-radio-group"),this.propagateControl(this.hostElement,"kol-select"),this.propagateControl(this.hostElement,"kol-textarea"))},this.catchHostElement=t=>{t instanceof HTMLElement&&(this.hostElement=t,this.syncControl())}}validateControl(t,e){"object"==typeof t&&"object"==typeof t.changeListeners&&"function"==typeof t.changeListeners.has&&"function"==typeof t.changeListeners.add&&("object"==typeof e&&"object"==typeof e.changeListeners&&"function"==typeof e.changeListeners.has&&"function"==typeof e.changeListeners.delete&&!0===e.changeListeners.has(this.changeListener)&&e.changeListeners.delete(this.changeListener),!1===t.changeListeners.has(this.changeListener)&&t.changeListeners.add(this.changeListener),r(this,"_control",t),this.syncControl())}validateDebounce(t){n(this,"_debounce",t)}validateOn(t){"object"==typeof t&&null!==t&&r(this,"_on",t)}componentWillLoad(){this.validateControl(this._control),this.validateDebounce(this._debounce),this.validateOn(this._on)}disconnectedCallback(){"object"==typeof this.state._control&&"object"==typeof this.state._control.changeListeners&&"function"==typeof this.state._control.changeListeners.delete&&this.state._control.changeListeners.delete(this.changeListener)}propagateControl(t,e){t.querySelectorAll(e).forEach((t=>{t instanceof HTMLElement&&(t._checked=!0===this.state._control.value,t._disabled=!0===this.state._control.disabled,t._error="string"==typeof this.state._control.error&&this.state._control.error.length>0?this.state._control.error:"",t._id=this.state._control.id,t._name=this.state._control.name,t._value=this.state._control.viewValue,t._on=Object.assign(Object.assign({},this.state._on),{onChange:this.onChange}),t._required=!0===this.state._control.mandatory,"string"==typeof this.state._control.label&&this.state._control.label.length>0&&(t.innerText=this.state._control.label))}))}render(){return e(s,{ref:this.catchHostElement},e("slot",null))}static get watchers(){return{_control:["validateControl"],_debounce:["validateDebounce"],_on:["validateOn"]}}};export{A as kol_input_adapter_leanup};