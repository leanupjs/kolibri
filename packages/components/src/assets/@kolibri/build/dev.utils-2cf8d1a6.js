/*!
 * KoliBri - the accessible web component library
 */
var e,n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(function(e){var t,o;t=n,o=function(){var e=function(){},t="undefined",o=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),n=["trace","debug","info","warn","error"];function i(e,t){var o=e[t];if("function"==typeof o.bind)return o.bind(e);try{return Function.prototype.bind.call(o,e)}catch(t){return function(){return Function.prototype.apply.apply(o,[e,arguments])}}}function r(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function s(n){return"debug"===n&&(n="log"),typeof console!==t&&("trace"===n&&o?r:void 0!==console[n]?i(console,n):void 0!==console.log?i(console,"log"):e)}function l(t,o){for(var i=0;i<n.length;i++){var r=n[i];this[r]=i<t?e:this.methodFactory(r,t,o)}this.log=this.debug}function a(e,o,n){return function(){typeof console!==t&&(l.call(this,o,n),this[e].apply(this,arguments))}}function c(e,t,o){return s(e)||a.apply(this,arguments)}function d(e,o,i){var r,s=this;o=null==o?"WARN":o;var a="loglevel";function d(){var e;if(typeof window!==t&&a){try{e=window.localStorage[a]}catch(e){}if(typeof e===t)try{var o=window.document.cookie,n=o.indexOf(encodeURIComponent(a)+"=");-1!==n&&(e=/^([^;]+)/.exec(o.slice(n))[1])}catch(e){}return void 0===s.levels[e]&&(e=void 0),e}}"string"==typeof e?a+=":"+e:"symbol"==typeof e&&(a=void 0),s.name=e,s.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},s.methodFactory=i||c,s.getLevel=function(){return r},s.setLevel=function(o,i){if("string"==typeof o&&void 0!==s.levels[o.toUpperCase()]&&(o=s.levels[o.toUpperCase()]),!("number"==typeof o&&o>=0&&o<=s.levels.SILENT))throw"log.setLevel() called with invalid level: "+o;if(r=o,!1!==i&&function(e){var o=(n[e]||"silent").toUpperCase();if(typeof window!==t&&a){try{return void(window.localStorage[a]=o)}catch(e){}try{window.document.cookie=encodeURIComponent(a)+"="+o+";"}catch(e){}}}(o),l.call(s,o,e),typeof console===t&&o<s.levels.SILENT)return"No console available for logging"},s.setDefaultLevel=function(e){o=e,d()||s.setLevel(e,!1)},s.resetLevel=function(){s.setLevel(o,!1),function(){if(typeof window!==t&&a){try{return void window.localStorage.removeItem(a)}catch(e){}try{window.document.cookie=encodeURIComponent(a)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}()},s.enableAll=function(e){s.setLevel(s.levels.TRACE,e)},s.disableAll=function(e){s.setLevel(s.levels.SILENT,e)};var u=d();null==u&&(u=o),s.setLevel(u,!1)}var u=new d,h={};u.getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=h[e];return t||(t=h[e]=new d(e,u.getLevel(),u.methodFactory)),t};var f=typeof window!==t?window.log:void 0;return u.noConflict=function(){return typeof window!==t&&window.log===u&&(window.log=f),u},u.getLoggers=function(){return h},u.default=u,u},e.exports?e.exports=o():t.log=o()}(e={path:void 0,exports:{},require:function(){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}()}}),e.exports);class o{constructor(){this.services=new Map,this.lazyLoaders=new Set}register(e,t,o={lazy:!1}){if("string"==typeof e&&!1===this.services.has(e))return this.services.set(e,t),!0===(null==o?void 0:o.lazy)&&this.lazyLoaders.add(e),this;throw new Error(`The service '${e}' is allready registered!`)}get(e){if(this.lazyLoaders.has(e)&&(this.services.set(e,this.services.get(e)()),this.lazyLoaders.delete(e)),"string"==typeof e&&!0===this.services.has(e))return this.services.get(e);throw new Error(`The service '${e}' is not registered!`)}}const i=new o,r=[];class s{constructor(e,t={}){this.shield=[`%c${e}`,"string"==typeof t.shieldStyle&&t.shieldStyle.length>0?t.shieldStyle:"color: white; background: #666; font-weight: bold; font-size: 10px; padding: 2px 6px; border-radius: 3px; border: 1px solid #000"]}static getInstance(e,t={}){if("string"==typeof e&&e.length>0)return!1===s.instances.has(e)&&s.instances.set(e,new s(e)),s.instances.get(e);throw new Error("The identifier of the Logger must be a string with a min length of 1.")}log(e,o){switch("object"==typeof o.refObject&&null!==o.refObject&&"function"==typeof o.refObject.constructor&&"string"==typeof o.refObject.constructor.name&&(o.className=`[${o.refObject.constructor.name}]:`),r.push({date:(new Date).toUTCString(),level:e,message:o}),e){case"trace":t.trace(...this.shield,o);break;case"debug":t.debug(...this.shield,o);break;case"info":t.info(...this.shield,o);break;case"warn":t.warn(...this.shield,o);break;default:t.error(...this.shield,o)}}trace(e,t){return this.log("trace",{messageText:e,refObject:t}),this}debug(e,t){return this.log("debug",{messageText:e,refObject:t}),this}info(e,t){return this.log("info",{messageText:e,refObject:t}),this}warn(e,t){return this.log("warn",{messageText:e,refObject:t}),this}error(e,t){return this.log("error",{messageText:e,refObject:t}),this}static get cache(){return[].concat(r)}}s.instances=new Map,t.setDefaultLevel("error");const l=s.getInstance("leanup");class c{constructor(){this.lockedElements=new Map,this.modalStack=new Map}lockElement(e){const t=e.getAttribute("tabindex");(e instanceof HTMLAnchorElement||e instanceof HTMLButtonElement||e instanceof HTMLInputElement||e instanceof HTMLSelectElement||e instanceof HTMLTextAreaElement||"string"==typeof t||void 0!==e.dataset.kolModal)&&(this.lockedElements.set(e,"string"==typeof t?{tabIndex:t}:{}),e.setAttribute("tabindex","-1"),e.setAttribute("aria-hidden","true"),e.style.userSelect="none")}unlockElement(e,t){"string"==typeof e.tabIndex?t.setAttribute("tabindex",e.tabIndex):t.removeAttribute("tabindex"),t.removeAttribute("aria-hidden"),t.style.userSelect="unset",this.lockedElements.delete(t)}unlockLockedElements(e){e.forEach(this.unlockElement.bind(this))}lockFocus(e,t){if(e!==t&&(e instanceof HTMLElement||e instanceof ShadowRoot)){e instanceof HTMLElement&&(this.lockElement(e),this.lockFocus(e.shadowRoot,t));for(let o=0;o<e.children.length;o++)this.lockFocus(e.children[o],t)}}renderModalIfExists(e){if(e instanceof HTMLElement){this.lockedElements.has(e)&&this.unlockElement(this.lockedElements.get(e),e);const t=setTimeout((()=>{clearTimeout(t),e.focus()}),500)}if(this.unlockLockedElements(this.lockedElements),this.modalStack.size>0){const e=Array.from(this.modalStack.keys()),t=e[e.length-1];this.modalStack.forEach(((e,o)=>{o.style.display=t===o?"inline":"none"})),h().body.style.maxHeight="100vh",h().body.style.overflow="hidden",this.lockFocus(h().body,t)}else h().body.style.maxHeight="unset",h().body.style.overflow="unset"}openModal(e,t){e instanceof HTMLElement==0?b.warn("[KolModalService] Die DOM-Referenz des Modals ist nicht valide."):(this.modalStack.set(e,{activeElement:t}),this.renderModalIfExists())}closeModal(e){var t;if(e instanceof HTMLElement==0)b.warn("[KolModalService] Die DOM-Referenz des Modals ist nicht valide.");else{const o=null===(t=this.modalStack.get(e))||void 0===t?void 0:t.activeElement;this.modalStack.delete(e),this.renderModalIfExists(o)}}}let a=null,u=null;const d=e=>{e instanceof Window?(a=e,a.document instanceof Document?u=e.document:console.warn("The given Window has no valid Document.")):console.warn("The given Window is not valid.")},f=()=>a||"undefined"==typeof window?null:window,h=()=>u||void 0===f().document?null:f().document;let w=null,p=null,g=null;const v=()=>!0===p,y=()=>!0===g;class b{static mapToArray(e){return Array.isArray(e)?e:[e]}static handleClassifier(e){return"string"==typeof e&&e.length>0?`${b.shield.label} | ${e}`:b.shield.label}static getShield(e){return[b.handleClassifier(null==e?void 0:e.classifier),`${b.shield.style};${(null==e?void 0:e.overwriteStyle)||""}`]}static debug(e,t){(p||!0===(null==t?void 0:t.forceLog))&&console.log(...b.getShield(t),...b.mapToArray(e))}static info(e,t){(p||!0===(null==t?void 0:t.forceLog))&&console.info(...b.getShield(t),...b.mapToArray(e))}static trace(e,t){(p||!0===(null==t?void 0:t.forceLog))&&console.trace(...b.getShield(t),...b.mapToArray(e))}static warn(e,t){(p||!0===(null==t?void 0:t.forceLog))&&console.warn(...b.getShield(t),...b.mapToArray(e))}static error(e,t){(p||!0===(null==t?void 0:t.forceLog))&&console.error(...b.getShield(t),...b.mapToArray(e))}static throw(e,t){if(p||!0===(null==t?void 0:t.forceLog))throw new Error(...b.getShield(t),...b.mapToArray(e))}}b.shield={label:"%cKoliBri",style:"color: white; background: #666; font-weight: bold; padding: .25em .5em; border-radius: 3px; border: 1px solid #000"};let m=null;const T=()=>m||{},E=()=>{null===m?(m=f().KoliBri||{},i.register("ModalService",new c),Object.defineProperty(m,"DI",{get:function(){return i}}),Object.defineProperty(m,"ModalService",{get:function(){return i.get("ModalService")}}),(()=>{if(null===p&&null===g){const e=h().querySelector('meta[name="kolibri"]');e&&e.hasAttribute("content")&&(w=e.getAttribute("content"),"string"==typeof w&&(p=w.includes("dev-mode=true"),g=w.includes("color-contrast-analysis=true")))}else console.warn("You can only initialize DEV_MODE and COLOR_CONTRAST_ANALYSIS once.")})()):console.warn("You can only initialize KoliBri once.")},M=()=>{void 0===f().KoliBri&&Object.defineProperty(window,"KoliBri",{get:function(){return m}}),!0!==T().adviceShown&&(Object.defineProperty(m,"adviceShown",{get:function(){return!0}}),b.debug("\n\nSie verwenden die KoliBri-Komponenten-Bibliothek. Sollten Sie Verbesserungsvorschläge haben oder ein Problem feststellen, dann wenden Sie sich gerne an kolibri@itzbund.de.\n\nHinweise:\n- WAI Web Accessibility Tutorials (https://www.w3.org/WAI/tutorials/)\n- The first rule of ARIA is “Don't use ARIA” (https://cccaccessibility.org/web-1/web-developer-tutorials/how-not-to-use-aria)\n- BIK BITV-Test (https://www.bitvtest.de/bitv_test.html)\n- A11y-Checkliste (https://www.a11yproject.com/checklist/)\n- BSI CON.10: Entwicklung von Webanwendungen (Edition 2021)\n\n"))};let x=()=>Math.floor(16777215*Math.random()).toString(16);export{o as I,m as K,b as L,f as a,l as b,d as c,T as d,v as e,y as f,h as g,E as i,t as l,x as n,M as r};